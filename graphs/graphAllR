# -*- coding: utf-8 -*-
import sys
import matplotlib
import matplotlib.pyplot as plt
import numpy as np
from numpy import genfromtxt

matplotlib.rcParams.update({'font.size': 22})

if(3 > len(sys.argv)):
    print("ERROR: Modo de uso: " + sys.argv[0] + " ROUTE TYPE(N|C|B)")
    sys.exit(1)

route = sys.argv[1]
inType = sys.argv[2]

possibleTypes = ("N", "C", "B")


if(inType not in possibleTypes):
    print("ERROR: Invalid type(P|N|C): " + inType)
    sys.exit(1)

if("N" == inType):
    title = u"Cantidad de vértices por partición para cada función de ranking."
    ylabel = u"Cantidad de particiones"
elif("C" == inType):
    title = u"Cantidad de cliques por partición para cada función de ranking."
    ylabel = u"Cantidad de particiones"
elif("B" == inType):
    title = u"Cantidad de bytes por vértice por partición para cada función de ranking."
    ylabel = u"Cantidad de particiones"

bytesPerNode = []

filename = "stats.r.out.csv"

graphFolders = (
    "marknewman-astro",
    "marknewman-condmat",
    "dblp-2010",
    "dblp-2011",
    "snap-dblp",
    "snap-amazon",
    "coPapersDBLP",
    "coPapersCiteseer"
)

graphNames = (
    "marknewman-astro",
    "marknewman-condmat",
    "dblp-2010",
    "dblp-2011",
    "snap-dblp",
    "snapd-amazon",
    "coPapersDBLP",
    "coPapersCiteseer"
)

labels = ("$r_r$", "$r_c$", "$r_f$")

colors = ("#2c7fb8", "#7fcdbb", "#edf8b1")
colors = ("#31a354", "#addd8e", "#f7fcb9")

partitions = { i : [0, 0, 0] for i in graphFolders}
# print(partitions)
partitionDict = { i : {j : {} for j in filenames} for i in graphFolders}
# print(partitionDict)

for i, folder in enumerate(graphFolders):
    for j, filename in enumerate(filenames):
        partitionsData = genfromtxt(route + folder + "/" + filename, delimiter=' ',dtype=str)

        for k, pData in enumerate(partitionsData):
            if(k != 0):
                if("P" == inType):
                    partitions[folder][j] += 1
                elif("N" == inType):
                    pData = int(pData[0])
                    if(partitions[folder][j] < pData):
                        partitions[folder][j] = pData
                elif("C" == inType):
                    pData = int(pData[2])
                    if(partitions[folder][j] < pData):
                        partitions[folder][j] = pData
                elif("B" == inType):
                    pData = int(pData[1])
                    if(partitions[folder][j] < pData):
                        partitions[folder][j] = pData
                elif("cc" == inType):
                    if("stats.r.out.csv" != filename):
                        continue
                    pData = int(pData[0])
                    if pData not in partitionDict[folder][filename]:
                        partitionDict[folder][filename][pData] = 0
                    partitionDict[folder][filename][pData] += 1


if("cc" == inType):
    x = partitionDict[folder]["stats.r.out.csv"].keys()
    y = partitionDict[folder]["stats.r.out.csv"].vals()
    plt.bar(x, y)

x = np.arange(len(graphFolders))
w = 0.3

for i, folder in enumerate(graphFolders):
    plt.bar(x[i] - w, partitions[folder][0], width=w, color=colors[0], edgecolor="black")
    plt.bar(x[i], partitions[folder][1], width=w, color=colors[1], edgecolor="black")
    plt.bar(x[i] + w, partitions[folder][2], width=w, color=colors[2], edgecolor="black")


plt.title(title, fontsize=20)
plt.ylabel(ylabel)
plt.ticklabel_format(style='sci', axis='y', scilimits=(0,0))
plt.xticks(x, graphNames, rotation=20, fontsize=20)
plt.xlabel("Grafos")
# plt.grid(True)
plt.gca().yaxis.grid(True)
plt.legend(labels)
plt.show()
